```{r}
library(tidytuesdayR)
library(tidyverse)
tuesdata <- tt_load('2020-02-18')
fc <- tuesdata$food_consumption
```

```{r}
fc |>
  mutate(food_category = fct_recode(food_category, "Lamb" = "Lamb & Goat", "Dairy" = "Milk - inc. cheese", "Wheat" = "Wheat and Wheat Products", "Nuts" = "Nuts inc. Peanut Butter")) |>
  group_by(country) |>
  summarize(totalcons = sum(consumption)) |>
  select(country, totalcons) |>
  arrange(desc(totalcons)) |>
  head(5) |>
  
  ggplot(aes(x = totalcons, fill = country)) +
  geom_bar() +
  scale_fill_viridis_d() +
  theme_minimal() +
  labs(x = "Country", y = "Count", color = "Country")

```

```{r}
fc |>
  mutate(food_category = fct_recode(food_category, "Lamb" = "Lamb & Goat", "Dairy" = "Milk - inc. cheese", "Wheat" = "Wheat and Wheat Products", "Nuts" = "Nuts inc. Peanut Butter")) |>
  group_by(country) |>
  summarize(totalcons = sum(consumption)) |>
  select(country, totalcons) |>
  arrange(desc(totalcons)) |>
  head(5) |>
  
  ggplot(aes(x = totalcons, fill = country)) +
  geom_boxplot() +
  scale_fill_viridis_d() +
  theme_minimal() +
  labs(x = "Country", y = "Count", color = "Country")
```


```{r}
fc |>
  mutate(food_category = fct_recode(food_category, "Lamb" = "Lamb & Goat", "Dairy" = "Milk - inc. cheese", "Wheat" = "Wheat and Wheat Products", "Nuts" = "Nuts inc. Peanut Butter")) |>
  group_by(food_category) |>
  slice_max(consumption)
  
  
```

